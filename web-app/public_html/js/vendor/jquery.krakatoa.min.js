(function(e,c,a,h){var g={width:"400px",height:"300px",display:"block",arrows:true,buttons:true,items:1,first:0,gutter:10,loop:false,autoplay:true,direction:1,delay:2000,duration:500,easing:"swing"};
function b(j,i){this.deferred=null;this.frameId=0;this.playing=false;this.slider=e(j);this.settings=e.extend({},g,i,f(this.slider.data("settings")));this.init();
}b.prototype={init:function(){var v=this,k=v.slider,o=v.settings,m=k.children().length,p,u,n,l,t,j,s,q,r=0;k.html('<div class="krakatoa-control"></div><div class="krakatoa-container">'+k.html()+"</div>");
j=k.find(".krakatoa-container");k.css({position:"relative",width:o.width,display:o.display});j.css({overflow:"hidden",position:"relative"});j.children().css({position:"absolute",top:0,left:0,display:"none"});
l=k.width();n=(l-(o.items-1)*o.gutter)/o.items;for(p=0;p<m;p++){u=j.children().eq(p);u.css("width",n);if(o.height==="max"){t=u.outerHeight(true);if(t>r){r=t;
}}}for(p=0;p<o.items&&o.first+p<m;p++){u=j.children().eq(o.first+p);u.addClass("current").css({display:"block",left:(n+o.gutter)*p});if(o.height!=="max"){r=o.height==="auto"?u.outerHeight(true):o.height;
}}j.css("height",r);k.data("current",o.first);if(o.items<m){if(o.arrows){k.find(".krakatoa-control").append('<div class="arrows"><a class="arrow arrow-left icon-left" data-direction="-1" href="#"></a><a class="arrow arrow-right icon-right" data-direction="1" href="#"></a></div>');
k.find(".arrow").on("click touchstart",{krakatoa:v},d);}if(o.buttons){q='<ul class="buttons">';for(p=0;p<m/o.items;p++){q+='<li class="pagination"><a href="#">'+p+"</a></li>";
}q+="</ul>";k.find(".krakatoa-control").append(q);k.find(".buttons a").on("click touchstart",{krakatoa:v},d);k.find(".buttons").find("li").eq(o.first).addClass("active-button");
}}if(o.autoplay){v.play();k.on("mouseleave",function(){v.play();});k.on("mouseover",function(){clearTimeout(v.frameId);v.playing=false;});}},play:function(){var i=this;
i.playing=true;i.frameId=c.setTimeout(function(){if(i.slider.find(":animated").length===0){i.do_the_move(i.settings.direction);}i.deferred.done(function(){if(i.playing){i.play();
}});},i.settings.delay);},do_the_move:function(v){var y=this,l=this.slider,p=this.settings,j=l.find(".krakatoa-container"),m=j.children().length,s=parseInt(l.data("current")),r=s+p.items*v,o=v/Math.abs(v),q,x,n,k,w,u=0,t=0;
y.deferred=e.Deferred();if(p.loop&&(r<0||r>=m)){r=Math.ceil(m/p.items)*p.items-r*o;}else{if(r<0||r>=m){y.deferred.resolve();return;}}k=l.width();n=(k-(p.items-1)*p.gutter)/p.items;
for(q=0;q<p.items;q++){x=j.children().eq(s+q);x.removeClass("current").animate({left:-(k+p.gutter)*o+(n+p.gutter)*q},p.duration,p.easing,function(){e(this).css({left:0,display:"none"});
});if(r+q>m-1){continue;}t++;x=j.children().eq(r+q);x.addClass("current").css({display:"block",left:(k+p.gutter)*o+(n+p.gutter)*q}).animate({left:(n+p.gutter)*q},p.duration,p.easing,function(){if(--t===0){y.deferred.resolve();
}});if(p.height==="auto"){w=x.outerHeight(true);if(w>u){u=w;}j.css("height",u);}}l.data("current",r);s=Math.round(r/p.items);if(p.buttons){l.find(".active-button").removeClass("active-button").parent().children().eq(s).addClass("active-button");
}}};function d(m){var j=e(this),i=m.data.krakatoa,l=Math.round(i.slider.data("current")/i.settings.items),k;m.preventDefault();if(i.slider.find(":animated").length>0){return;
}if(j.data("direction")){k=j.data("direction");}else{if(i.settings.buttons){if(j.parent().hasClass("active-button")){return;}k=j.parent().index()-l;}}j.off("click touchstart").on("click touchstart",function(n){n.preventDefault();
});i.do_the_move(k);i.deferred.done(function(){j.off("click touchstart");j.on("click touchstart",{krakatoa:i},d);});}function f(k){var m=new Object(),n=[],j,l;
if(typeof k!=="string"){return m;}k=k.replace(/[{}\s]/g,"");n=k.split(",");for(j=0;j<n.length;j++){l=n[j].split(":");if(!isNaN(l[1]-0)){if(l[1]%1===0){l[1]=parseInt(l[1]);
}else{l[1]=parseFloat(l[1]);}}else{if(l[1].toLowerCase()=="true"||l[1].toLowerCase()=="false"){l[1]=(l[1]=="true");}}m[l[0]]=l[1];}return m;}e.fn.krakatoa=function(i){return this.each(function(){if(!e(this).data("krakatoa")){e.data(this,"krakatoa",new b(this,i));
}});};})(jQuery,window,document);